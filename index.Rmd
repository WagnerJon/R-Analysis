---
title: "RTrack Analysis"
author: "Jonas Wagner"
date: "`r Sys.Date()`"
output:
  rmdformats::downcute:
    self_contained: true
    includes: 
     before_body: header.html
bibliography: Bachelor Thesis.bib
csl: elsevier-harvard.csl
---


```{r setup, include=FALSE}
library(knitr)
library(rmdformats)
require("knitr")
knitr::opts_chunk$set(echo = TRUE,fig.width = 7,fig.height = 4)
opts_knit$set(root.dir = "F:/Bachelor/Daten/Bulk_all")
library(Rtrack)
library(knitr)
library(DT)
library(dplyr)
library(ggplot2)
library(readxl)
library(ggsci)
library(tidyverse)
library(ggh4x)
library(rmdformats)
library(plotly)

## Global options
options(max.print="75")
opts_chunk$set(echo=TRUE,
	             cache=TRUE,
               prompt=FALSE,
               comment=NA,
               message=FALSE,
               warning=FALSE)
opts_knit$set(width=75)
write_bib(file = "r-packages.bib")
```

***
## Table of Contents {#anchor99}

* [Importing Data](#anchor)  
* [Analysis of experiment metrics](#anchor2)  
* [Heatmap](#anchor3)  
* [Heatmap_reversal](#anchor4)
* [Strategies]()
  * [Calling strategies](#anchor5)  
  * [Thresholding strategies](#anchor6)  
  * [Plotting strategies](#anchor7)  
  * [Plotting thresholded strategies](#anchor8)  
  * [Saving the results](#anchor9)  
* [OLD Graphs](#anchor11)
  * [Plotting with ggplot2](#anchor10) 
  * [Path Length Graphs](#anchor12)
  * [Latency Graphs](#anchor13)
* [UPDATED Graphs](#anchor14)
  * [Heatmaps](#anchor14)
  * [Path length Graphs](#anchor15)
  * [Mean Velocity Graphs](#anchor16)
  * [Strategy Graphs](#anchor17)
* [Probe Trial Graphs](#anchor18)
  * [Number of goal crossings](#anchor18)
  * [Number of old goal crossings](#anchor19)
  * [Time in old goal zone](#anchor20)
  * [Mean Initial heading error](#anchor21)
* [Layout Test](#anchor22)
  * [Probe Trial Mean Distance old goal](#anchor23)  
* [Arena Quadrant Problem](#anchor24)
* [t-Tests](#anchor25)
  * [time in old goal zone of probe trials](#anchor26)
  * [time in old goal zone of probe trials](#anchor27)
  * [Path length of all trials](#anchor28)
  * [Latency to goal of all trials](#anchor29)
* [Logistic regression](#anchor30)
  * [17-25 Strain](#anchor31)
  * [13-14 Strain*Housing](#anchor32)
  * [3 Strain*Housing](#anchor33)
  * [17-25 acquisition Strain](#anchor34)
  * [17-25 reversal Strain*Housing](#anchor35)
  * [13-14 acquisition Strain*Housing](#anchor36)
  * [13-14 reversal Strain*Housing](#anchor37)
  * [3 acquisition Strain*Housing](#anchor38)
  * [3 reversal Strain*Housing](#anchor39)
* [Strategy overview plot](#anchor40)
* [Visualization results log.reg](#anchor41)
  * [2D - Age group 3 months](#anchor41.1)
  * [2D - Age group 13-14 months](#anchor41.2)
  * [2D - Age group 17-25 months](#anchor41.3)
  * [3D - Surface Plot 3 months](#anchor41.4)
* [References](#ref)
 

*** 

## Importing Data{#anchor}
Here a multicore CPU cluster is opened to reduce experiment reading times. This cluster is closed after the execution of the code. 
```{r import,results=FALSE}
cluster = parallel::makeCluster(rep("localhost", parallel::detectCores()), type = "SOCK")
experiment = Rtrack::read_experiment("Experiment_description2.xlsx", format = "Excel", cluster = cluster) 
parallel::stopCluster(cluster)
```
***  
## Analysis of experiment metrics{#anchor2}

These metrics can be compared and extracted from the pure track files.

```{r}
experiment$summary.variables
```
 [back to top](#anchor99)
```{r}
par(mfrow = c(2, 2))
Rtrack::plot_variable("path.length", experiment = experiment, factor = "Strain", exclude.probe = TRUE,lwd = 2)
Rtrack::plot_variable("path.length", experiment = experiment, factor = "Age_group", exclude.probe = TRUE,lwd = 2)
Rtrack::plot_variable("path.length", experiment = experiment, factor = "Housing", exclude.probe = TRUE,lwd = 2)
Rtrack::plot_variable("path.length", experiment = experiment, factor = "All", exclude.probe = TRUE,lwd = 2)
```
Note that the probe trials have been omitted from these plots.

[back to top](#anchor99)

***  

## Heatmap {#anchor3}
```{r heatmap}
wt.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
(experiment$factors$`_Day` == 1 | experiment$factors$`_Day` == 2 | experiment$factors$`_Day` == 3 | experiment$factors$`_Day` == 4|
experiment$factors$`_Day` == 5| experiment$factors$`_Day` == 6)]
dTg.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
(experiment$factors$`_Day` == 1 | experiment$factors$`_Day` == 2 | experiment$factors$`_Day` == 3 | experiment$factors$`_Day` == 4| experiment$factors$`_Day` == 5| experiment$factors$`_Day` == 6)]
APP.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
(experiment$factors$`_Day` == 1 | experiment$factors$`_Day` == 2 | experiment$factors$`_Day` == 3 | experiment$factors$`_Day` == 4| experiment$factors$`_Day` == 5| experiment$factors$`_Day` == 6)]
PS1.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
(experiment$factors$`_Day` == 1 | experiment$factors$`_Day` == 2 | experiment$factors$`_Day` == 3 | experiment$factors$`_Day` == 4| experiment$factors$`_Day` == 5| experiment$factors$`_Day` == 6)]
par(mfrow = c(2, 2))
Rtrack::plot_density(wt.metrics, title = "wt Heatmap",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(dTg.metrics, title = "dTg Heatmap",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(APP.metrics, title = "APPswe Heatmap",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(PS1.metrics, title = "PS1dE9 Heatmap",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
```  

[back to top](#anchor99)

***  

## Heatmap_reversal {#anchor4}
```{r heatmap reversal}
wtr.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
                                           (experiment$factors$`_Day` == 7 | experiment$factors$`_Day` == 8 | experiment$factors$`_Day` == 9 | experiment$factors$`_Day` == 10)]
dTgr.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
                                            (experiment$factors$`_Day` == 7 | experiment$factors$`_Day` == 8 | experiment$factors$`_Day` == 9 | experiment$factors$`_Day` == 10)]
APPr.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
                                  (experiment$factors$`_Day` ==7 | experiment$factors$`_Day` == 8 | experiment$factors$`_Day` == 9 | experiment$factors$`_Day` == 10)]
PS1r.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
                                   (experiment$factors$`_Day` == 7 | experiment$factors$`_Day` == 8 | experiment$factors$`_Day` == 9 | experiment$factors$`_Day` == 10)]
par(mfrow = c(2, 2))
Rtrack::plot_density(wtr.metrics, title = "WT_reversal Heatmap",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(dTgr.metrics, title = "dTg_reversal Heatmap",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(APPr.metrics, title = "APPswe_reversal Heatmap",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(PS1r.metrics, title = "PS1dE9_reversal Heatmap",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
```  

[back to top](#anchor99)  
  
***  
  
  
# Strategies {#anchor5}

## Calling strategies {#anchor5}
```{r}
strategies = Rtrack::call_strategy(experiment$metrics)
```
***  

## Thresholding strategies {#anchor6}

limits called strategies to those, where confidence is greater than 40%

```{r}
dim(Rtrack::threshold_strategies(strategies, 0.4)$calls)
```  

[back to top](#anchor99)  

***  

## Plotting strategies of all age groups combined {#anchor7}
```{r}
par(mfrow = c(2, 2))
Rtrack::plot_strategies(strategies, experiment = experiment, factor = "Strain",
    exclude.probe = TRUE)
```
[back to top](#anchor99)  
  
***  

## Plotting thresholded strategies of all age groups combined {#anchor8}
```{r}
par(mfrow = c(2, 2))
Rtrack::plot_strategies(Rtrack::threshold_strategies(strategies, 0.4), experiment = experiment,
                        factor = "Strain", exclude.probe = TRUE)
```  

[back to top](#anchor99)
  
***  

## Saving the results {#anchor9}  

Here we export the results of the analyzed Track Files into a data.frame, to analyse them further.
```{r}
results = Rtrack::export_results(experiment)
datatable(results, rownames = FALSE, filter="top", options = list(pageLength = 5, scrollX=T) )
```  

[back to top](#anchor99)
  
***  
  
# OLD Graphs {#anchor11}

## Plotting with ggplot2 {#anchor10}  
```{r warning=FALSE}
library(ggplot2)
library(readxl)
Results=read_excel("Results3.xlsx", col_types=c("text","text","text","text","text","text","logical","numeric","text","text","text","numeric","text","numeric","text","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric"))
ggplot(Results, aes(x=`_Day`,y=path.length,color=factor(Strain)))+geom_jitter()
Results

```  

[back to top](#anchor99)  

CAREFUL!!! The graphs below still include the probe trials (day 7 trial 1). To remove them add:   Probe=='FALSE' to filter  

***  

## Path Length Graphs {#anchor12}
```{r path length}

WT_STD=filter(Results, Strain=='WT'&Housing=='STD')
dTg_STD=filter(Results, Strain=='dTg'&Housing=='STD')
APP_STD=filter(Results, Strain=='APPswe'&Housing=='STD')
PS_STD=filter(Results, Strain=='PS1dE9'&Housing=='STD')
WT_ENR=filter(Results, Strain=='WT'&Housing=='ENR')
dTg_ENR=filter(Results, Strain=='dTg'&Housing=='ENR')
APP_ENR=filter(Results, Strain=='APPswe'&Housing=='ENR')
PS_ENR=filter(Results, Strain=='PS1dE9'&Housing=='ENR')
par(mfrow = c(2, 4))

WT_STD %>%
  mutate(WT_STD, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
  ggplot(aes(x=`_Day`,y=path.length, fill=Age_group))+geom_boxplot()+
    labs(x="Day",
       y="Average Path length",
       title="Mean Path length WT STD")+scale_fill_jco()
dTg_STD  %>%
mutate(dTg_STD, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=path.length, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Path length",
       title="Mean Path length dTg STD")+scale_fill_jco()
APP_STD  %>%
mutate(APP_STD, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=path.length, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Path length",
       title="Mean Path length APPswe1 STD")+scale_fill_jco()
PS_STD  %>%
mutate(PS_STD, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=path.length, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Path length",
       title="Mean Path length PS1dE9 STD")+scale_fill_jco()
WT_ENR  %>%
mutate(WT_ENR, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=path.length, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Path length",
       title="Mean Path length WT ENR")+scale_fill_jco()
dTg_ENR  %>%
mutate(dTg_ENR, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=path.length, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Path length",
       title="Mean Path length dTg ENR")+scale_fill_jco()
APP_ENR  %>%
mutate(APP_ENR, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=path.length, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Path length",
       title="Mean Path length APPswe1 ENR")+scale_fill_jco()
PS_ENR  %>%
mutate(PS_ENR, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=path.length, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Path length",
       title="Mean Path length PS1dE9 ENR")+scale_fill_jco()+
  facet_wrap(~Age_group)
```
[back to top](#anchor99)  
  
***  
  
## Latency Graphs {#anchor13}
```{r Latency}
WT_STD %>%
  mutate(WT_STD, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
  ggplot(aes(x=`_Day`,y=latency.to.goal, fill=Age_group))+geom_boxplot()+
    labs(x="Day",
       y="Average Latency in s",
       title="Mean Latency in s WT STD")+scale_fill_jco()
dTg_STD  %>%
mutate(dTg_STD, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=latency.to.goal, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Latency in s",
       title="Mean Latency in s dTg STD")+scale_fill_jco()
APP_STD  %>%
mutate(APP_STD, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=latency.to.goal, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Latency in s",
       title="Mean Latency in s APPswe1 STD")+scale_fill_jco()
PS_STD  %>%
mutate(PS_STD, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=latency.to.goal, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Latency in s",
       title="Mean Latency in s PS1dE9 STD")+scale_fill_jco()
WT_ENR  %>%
mutate(WT_ENR, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=latency.to.goal, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Latency in s",
       title="Mean Latency in s WT ENR")+scale_fill_jco()
dTg_ENR  %>%
mutate(dTg_ENR, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=latency.to.goal, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Latency in s",
       title="Mean Latency in s dTg ENR")+scale_fill_jco()
APP_ENR  %>%
mutate(APP_ENR, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=latency.to.goal, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Latency in s",
       title="Mean Latency in s APPswe1 ENR")+scale_fill_jco()
PS_ENR  %>%
mutate(PS_ENR, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=latency.to.goal, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Latency in s",
       title="Mean Latency in s PS1dE9 ENR")+scale_fill_jco()+
  facet_wrap(~Age_group)
```
[back to top](#anchor99) 
  
***   

# UPDATED Graphs {#anchor14}  

## Heatmap_probe
```{r filtering for heatmaps, include=FALSE}
#############Probe_Trials##################
wtp.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1)]
dTgp.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1)]
APPp.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1)]
PS1p.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1)]
###########################################
##############Probe_Trials_STD#############
wtpstd.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD")]

dTgpstd.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD")]

APPpstd.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD")]

PS1pstd.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD")]
#######################################
##############Probe_Trials_ENR#########
wtpenr.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR")]
dTgpenr.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR")]
APPpenr.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR")]
PS1penr.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR")]
####################################################
################Probe_Trial_Age_groups##############
#######################3_months#####################
wtpstd3.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="3")]

dTgpstd3.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="3")]

APPpstd3.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="3")]

PS1pstd3.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="3")]
#######################################
##############Probe_Trials_ENR#########
wtpenr3.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="3")]
dTgpenr3.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="3")]
APPpenr3.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="3")]
PS1penr3.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="3")]
#######################13-14_months#####################
wtpstd14.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="13-14")]

dTgpstd14.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="13-14")]

APPpstd14.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="13-14")]

PS1pstd14.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="13-14")]
#######################################
##############Probe_Trials_ENR#########
wtpenr14.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="13-14")]
dTgpenr14.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="13-14")]
APPpenr14.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="13-14")]
PS1penr14.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="13-14")]
#######################17-25_months#####################
wtpstd25.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="17-25")]

dTgpstd25.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="17-25")]

APPpstd25.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="17-25")]

PS1pstd25.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="17-25")]
#######################################
##############Probe_Trials_ENR#########
wtpenr25.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="17-25")]
dTgpenr25.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="17-25")]
APPpenr25.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="17-25")]
PS1penr25.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="17-25")]
```

```{r heatmap probe}
par(mfrow = c(2, 2))
Rtrack::plot_density(wtp.metrics, title = "WT Probe Heatmap 3-25mo",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(dTgp.metrics, title = "dTg Probe Heatmap 3-25mo",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(APPp.metrics, title = "APPswe Probe Heatmap 3-25mo",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(PS1p.metrics, title = "PS1dE9 Probe Heatmap 3-25mo",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
```

```{r heatmap probe ENR&STD}
par(mfrow = c(2, 4))
Rtrack::plot_density(wtpstd.metrics, title = "WT Probe Heatmap STD 3-25mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(dTgpstd.metrics, title = "dTg Probe Heatmap STD 3-25mo",    col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(APPpstd.metrics, title = "APPswe Probe Heatmap STD 3-25mo", col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(PS1pstd.metrics, title = "PS1dE9 Probe Heatmap STD 3-25mo", col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(wtpenr.metrics, title = "WT Probe Heatmap ENR 3-25mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(dTgpenr.metrics, title = "dTg Probe Heatmap ENR 3-25mo",    col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(APPpenr.metrics, title = "APPswe Probe Heatmap ENR 3-25mo", col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(PS1penr.metrics, title = "PS1dE9 Probe Heatmap ENR 3-25mo", col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
```
WT -> dTg -> APPswe -> PS1dE9  

[back to top](#anchor99)
```{r heatmap probe Age_groups}
par(mfrow = c(1, 3))
###########WT_Probe##########
Rtrack::plot_density(wtpstd3.metrics, title = "WT Probe Heatmap STD 3mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(wtpstd14.metrics, title = "WT Probe Heatmap STD 13-14mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(wtpstd25.metrics, title = "WT Probe Heatmap STD 17-25mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(wtpenr3.metrics, title = "WT Probe Heatmap ENR 3mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(wtpenr14.metrics, title = "WT Probe Heatmap ENR 13-14mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(wtpenr25.metrics, title = "WT Probe Heatmap ENR 17-25mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
###########dTg_Probe##########
Rtrack::plot_density(dTgpstd3.metrics, title = "dTg Probe Heatmap STD 3mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(dTgpstd14.metrics, title = "dTg Probe Heatmap STD 13-14mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(dTgpstd25.metrics, title = "dTg Probe Heatmap STD 17-25mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(dTgpenr3.metrics, title = "dTg Probe Heatmap ENR 3mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(dTgpenr14.metrics, title = "dTg Probe Heatmap ENR 13-14mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(dTgpenr25.metrics, title = "dTg Probe Heatmap ENR 17-25mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
###########APP_Probe##########
Rtrack::plot_density(APPpstd3.metrics, title = "APPswe Probe Heatmap STD 3mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
#Rtrack::plot_density(APPpstd14.metrics, title = "APPswe Probe Heatmap STD 13-14mo",
#  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(APPpstd25.metrics, title = "APPswe Probe Heatmap STD 17-25mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(APPpenr3.metrics, title = "APPswe Probe Heatmap ENR 3mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
#Rtrack::plot_density(APPpenr14.metrics, title = "APPswe Probe Heatmap ENR 13-14mo",
#  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(APPpenr25.metrics, title = "APPswe Probe Heatmap ENR 17-25mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
###########PS1_Probe##########
Rtrack::plot_density(PS1pstd3.metrics, title = "PS1dE9 Probe Heatmap STD 3mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
#Rtrack::plot_density(PS1pstd14.metrics, title = "PS1dE9 Probe Heatmap STD 13-14mo",
#  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(PS1pstd25.metrics, title = "PS1dE9 Probe Heatmap STD 17-25mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(PS1penr3.metrics, title = "PS1dE9 Probe Heatmap ENR 3mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
#Rtrack::plot_density(PS1penr14.metrics, title = "PS1dE9 Probe Heatmap ENR 13-14mo",
#  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(PS1penr25.metrics, title = "PS1dE9 Probe Heatmap ENR 17-25mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
```
[back to top](#anchor99)  
  
***  

## Path Length Graphs {#anchor15}
```{r path length updated}

mo3=filter(Results, Age_group=='3')
mo14=filter(Results, Age_group=='13-14')
mo25=filter(Results, Age_group=='17-25')

mo3 %>%
  mutate(mo3, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
  ggplot(aes(x=`_Day`,y=path.length, fill=Condition))+geom_boxplot()+
    labs(x="Day",
       y="Average Path length",
       title="Mean Path length 3mo mice")+scale_fill_manual(values = c("dTg_ENR" = "#ad5fc9", "dTg_STD" = "#bc91cc","WT_ENR" = "#6eca64", "WT_STD" = "#98cc93","APPswe_ENR" = "#d6564b", "APPswe_STD" = "#db867f","PS1dE9_ENR" = "#918730", "PS1dE9_STD" = "#c5b740"))
mo14  %>%
mutate(mo14, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=path.length, fill=Condition))+geom_boxplot()+
  labs(x="Day",
       y="Average Path length",
       title="Mean Path length 13-14mo mice")+scale_fill_manual(values = c("dTg_ENR" = "#ad5fc9", "dTg_STD" = "#bc91cc","WT_ENR" = "#6eca64", "WT_STD" = "#98cc93","APPswe_ENR" = "#d6564b", "APPswe_STD" = "#db867f","PS1dE9_ENR" = "#918730", "PS1dE9_STD" = "#c5b740"))
mo25  %>%
mutate(mo25, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=path.length, fill=Condition))+geom_boxplot()+
  labs(x="Day",
       y="Average Path length",
       title="Mean Path length 17-25mo mice")+scale_fill_manual(values = c("dTg_ENR" = "#6c7ed7", "dTg_STD" = "#909ef3","WT_ENR" = "#9f48a3", "WT_STD" = "#ce73cf","APPswe_ENR" = "#c85632", "APPswe_STD" = "#e9724b","PS1dE9_ENR" = "#9f9201", "PS1dE9_STD" = "#cab95b"))
```
[back to top](#anchor99)

Boxplot explanation:   
Middle line in box -> Median   
Box -> shows middle 50% of data(Distance between 1. and 3. Quartil)   
Whisker(vertikal lines) -> show upper/lower 25% of data w/o outliers   
Points -> outlier
  
***  

## Velocity (Mean) Graphs {#anchor16}
```{r velocity updated}

mo3=filter(Results, Age_group=='3')
mo14=filter(Results, Age_group=='13-14')
mo25=filter(Results, Age_group=='17-25')

mo3 %>%
  mutate(mo3, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
  ggplot(aes(x=`_Day`,y=mean.velocity, fill=Condition))+geom_boxplot()+
    labs(x="Day",
       y="Average Velocity",
       title="Mean Velocity 3mo mice")+scale_fill_manual(values = c("dTg_ENR" = "#ad5fc9", "dTg_STD" = "#bc91cc","WT_ENR" = "#6eca64", "WT_STD" = "#98cc93","APPswe_ENR" = "#d6564b", "APPswe_STD" = "#db867f","PS1dE9_ENR" = "#918730", "PS1dE9_STD" = "#c5b740"))
mo14  %>%
mutate(mo14, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=mean.velocity, fill=Condition))+geom_boxplot()+
  labs(x="Day",
       y="Average Velocity",
       title="Mean Velocity 13-14mo mice")+scale_fill_manual(values = c("dTg_ENR" = "#ad5fc9", "dTg_STD" = "#bc91cc","WT_ENR" = "#6eca64", "WT_STD" = "#98cc93","APPswe_ENR" = "#d6564b", "APPswe_STD" = "#db867f","PS1dE9_ENR" = "#918730", "PS1dE9_STD" = "#c5b740"))
mo25  %>%
mutate(mo25, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=mean.velocity, fill=Condition))+geom_boxplot()+
  labs(x="Day",
       y="Average Velocity",
       title="Mean Velocity 17-25mo mice")+scale_fill_manual(values = c("dTg_ENR" = "#6c7ed7", "dTg_STD" = "#909ef3","WT_ENR" = "#9f48a3", "WT_STD" = "#ce73cf","APPswe_ENR" = "#c85632", "APPswe_STD" = "#e9724b","PS1dE9_ENR" = "#9f9201", "PS1dE9_STD" = "#cab95b"))
```
[back to top](#anchor99)  
  
***  

## Strategy (Thresholded) Graphs {#anchor17}  
```{r}
par(mfrow = c(2, 2))
Rtrack::plot_strategies(Rtrack::threshold_strategies(strategies, 0.4), experiment = experiment,
                        factor = "All", exclude.probe = TRUE)
```  

[back to top](#anchor99)  

  
***  

# Probe Trial Graphs {#anchor18}  

## Probe Trial Number of Goals Crossings {#anchor18}
```{r Number of Goal Crossings}

mo3.probe=filter(Results, Age_group=='3'&`_Day`=='7'&`_Trial`=='1')
mo14.probe=filter(Results, Age_group=='13-14'&`_Day`=='7'&`_Trial`=='1')
mo25.probe=filter(Results, Age_group=='17-25'&`_Day`=='7'&`_Trial`=='1')

mo3.probe %>%
  ggplot(aes(x=`Strain`,y=goal.crossings, fill=Housing))+geom_boxplot()+
    labs(x="Condition",
       y="Number of Goal Crossings",
       title="Probe Trial Number of Goal Crossings 3mo mice")+scale_fill_manual(values = c("ENR"="#b3669e","STD"="#98984d"))
mo14.probe  %>%
ggplot(aes(x=`Strain`,y=goal.crossings, fill=Housing))+geom_boxplot()+
  labs(x="Condition",
       y="Number of Goal Crossings",
       title="Probe Trial Number of Goal Crossings 13-14mo mice")+scale_fill_manual(values = c("ENR"="#b3669e","STD"="#98984d"))
mo25.probe  %>%
ggplot(aes(x=`Strain`,y=goal.crossings, fill=Housing))+geom_boxplot()+
  labs(x="Condition",
       y="Number of Goal Crossings",
       title="Probe Trial Number of Goal Crossings 17-25mo mice")+scale_fill_manual(values = c("ENR"="#b3669e","STD"="#98984d"))
```
   
[back to top](#anchor99)  

***  

## Probe Trial Number of former Goals Crossings {#anchor19}
```{r Number of old Goal Crossings}

mo3.probe=filter(Results, Age_group=='3'&`_Day`=='7'&`_Trial`=='1')
mo14.probe=filter(Results, Age_group=='13-14'&`_Day`=='7'&`_Trial`=='1')
mo25.probe=filter(Results, Age_group=='17-25'&`_Day`=='7'&`_Trial`=='1')

mo3.probe %>%
  ggplot(aes(x=`Strain`,y=old.goal.crossings, fill=Housing))+geom_boxplot()+
    labs(x="Condition",
       y="Number of old Goal Crossings",
       title="Probe Trial Number of former Goal Crossings 3mo mice")+scale_fill_manual(values = c("ENR"="#b3669e","STD"="#98984d"))
mo14.probe  %>%
  ggplot(aes(x=`Strain`,y=old.goal.crossings, fill=Housing))+geom_boxplot()+
    labs(x="Condition",
       y="Number of old Goal Crossings",
       title="Probe Trial Number of former Goal Crossings 13-14mo mice")+scale_fill_manual(values = c("ENR"="#b3669e","STD"="#98984d"))
mo25.probe  %>%
  ggplot(aes(x=`Strain`,y=old.goal.crossings, fill=Housing))+geom_boxplot()+
    labs(x="Condition",
       y="Number of Old Goal Crossings",
       title="Probe Trial Number of former Goal Crossings 17-25mo mice")+scale_fill_manual(values = c("ENR"="#b3669e","STD"="#98984d"))
```
   
[back to top](#anchor99)  
  
***  
  
## Probe Trial Time in old goal zone {#anchor20}
```{r Time spent old Goal}

mo3.probe=filter(Results, Age_group=='3'&`_Day`=='7'&`_Trial`=='1')
mo14.probe=filter(Results, Age_group=='13-14'&`_Day`=='7'&`_Trial`=='1')
mo25.probe=filter(Results, Age_group=='17-25'&`_Day`=='7'&`_Trial`=='1')

mo3.probe %>%
  ggplot(aes(x=`Strain`,y=time.in.zone.old.goal, fill=Housing))+geom_boxplot()+
    labs(x="Condition",
       y="Time in s",
       title="Probe Trial Time spent in old goal 3mo mice")+scale_fill_manual(values = c("ENR"="#b3669e","STD"="#98984d"))
mo14.probe  %>%
  ggplot(aes(x=`Strain`,y=old.goal.crossings, fill=Housing))+geom_boxplot()+
    labs(x="Condition",
       y="Time in s",
       title="Probe Trial Time spent in old goal 13-14mo mice")+scale_fill_manual(values = c("ENR"="#b3669e","STD"="#98984d"))
mo25.probe  %>%
  ggplot(aes(x=`Strain`,y=old.goal.crossings, fill=Housing))+geom_boxplot()+
    labs(x="Condition",
       y="Time in s",
       title="Probe Trial Time spent in old goal 17-25mo mice")+scale_fill_manual(values = c("ENR"="#b3669e","STD"="#98984d"))
```

[back to top](#anchor99)  
  
***  
  
## Probe Trial Mean Initial heading error {#anchor21}
```{r Mean Initial heading error}

mo3.probe=filter(Results, Age_group=='3'&`_Day`=='7'&`_Trial`=='1')
mo14.probe=filter(Results, Age_group=='13-14'&`_Day`=='7'&`_Trial`=='1')
mo25.probe=filter(Results, Age_group=='17-25'&`_Day`=='7'&`_Trial`=='1')

mo3.probe %>%
  ggplot(aes(x=`Strain`,y=`mean.initial.heading.error`, fill=Housing))+geom_boxplot()+
    labs(x="Condition",
       y="Initial heading error in %??",
       title="Probe Trial Mean Initial heading error 3mo mice")+scale_fill_manual(values = c("ENR"="#b3669e","STD"="#98984d"))
mo14.probe  %>%
  ggplot(aes(x=`Strain`,y=`mean.initial.heading.error`, fill=Housing))+geom_boxplot()+
    labs(x="Condition",
       y="Initial heading error in %??",
       title="Probe Trial Mean Initial heading error 13-14mo mice")+scale_fill_manual(values = c("ENR"="#b3669e","STD"="#98984d"))
mo25.probe  %>%
  ggplot(aes(x=`Strain`,y=`mean.initial.heading.error`, fill=Housing))+geom_boxplot()+
    labs(x="Condition",
       y="Initial heading error in ???",
       title="Probe Trial Mean Initial heading error 17-25mo mice")+scale_fill_manual(values = c("ENR"="#b3669e","STD"="#98984d"))
```
  
[back to top](#anchor99)  
  
## Probe Trial Mean Distance old goal {.tabset .tabset-fade .tabset-pills #anchor23}  
  
***  

### 3 Months  
```{r mean dist old goal 3months}
mo3.probe %>%
  ggplot(aes(x=`Strain`,y=`mean.d.old.goal`, fill=Housing))+geom_boxplot()+
    labs(x="Condition",
       y="Distance",
       title="Probe Trial Mean Distance old goal 3mo mice")+scale_fill_manual(values = c("ENR"="#b3669e","STD"="#98984d"))
```

### 13-14 Months  
```{r}
mo14.probe  %>%
  ggplot(aes(x=`Strain`,y=`mean.d.old.goal`, fill=Housing))+geom_boxplot()+
    labs(x="Condition",
       y="Distance",
       title="Probe Trial Mean Distance old goal 13-14mo mice")+scale_fill_manual(values = c("ENR"="#b3669e","STD"="#98984d"))
```

### 17-25 Months
```{r}
mo25.probe  %>%
  ggplot(aes(x=`Strain`,y=`mean.d.old.goal`, fill=Housing))+geom_boxplot()+
    labs(x="Condition",
       y="Distance",
       title="Probe Trial Mean Distance old goal 17-25mo mice")+scale_fill_manual(values = c("ENR"="#b3669e","STD"="#98984d"))
```  

# Arena Quadrant Problem {#anchor24}

***  

[back to top](#anchor99)  

```{r}
knitr::include_graphics("Watermaze_Setup.png")
```
In Ethovision those Quadrants are marked (NE, SE, SW, NW).  
In contrast to that, the quadrants that can be analyzed with RTrack are called as below:  
*"time.in.zone.n.quadrant"  
*"time.in.zone.e.quadrant"        
*"time.in.zone.s.quadrant"  
*"time.in.zone.w.quadrant"  
```{r}
knitr::include_graphics("Watermaze_Quadrant.png")
```


# t-Tests {#anchor25}

## t-Tests (time in old goal zone of probe trials) between Age Groups {.tabset .tabset-fade .tabset-pills #anchor26}
  
***  

### 3 / 13-14
```{r}
t.test(mo3.probe$time.in.zone.old.goal,mo14.probe$time.in.zone.old.goal)
```
  
### 3 / 17-25  
```{r}
t.test(mo3.probe$time.in.zone.old.goal,mo25.probe$time.in.zone.old.goal)
```
  
### 13-14 / 17-25  
```{r}
t.test(mo14.probe$time.in.zone.old.goal,mo25.probe$time.in.zone.old.goal)
```
## {-}

no significance between the overall groups

<br>  

## t-Tests (time in old goal zone of probe trials) between Strains & Housings of Age Group 17-25 {.tabset .tabset-fade .tabset-pills #anchor27}
  
***  

### 17-25 WT STD/ENR
```{r}
WTS.mo25.probe=filter(mo25.probe, Strain=='WT'&`Housing`=='STD')
WTE.mo25.probe=filter(mo25.probe, Strain=='WT'&`Housing`=='ENR')
t.test(WTS.mo25.probe$time.in.zone.old.goal,WTE.mo25.probe$time.in.zone.old.goal)
```  
### 13-14 WT STD/ENR
```{r}
WTS.mo14.probe=filter(mo14.probe, Strain=='WT'&`Housing`=='STD')
WTE.mo14.probe=filter(mo14.probe, Strain=='WT'&`Housing`=='ENR')
t.test(WTS.mo14.probe$time.in.zone.old.goal,WTE.mo14.probe$time.in.zone.old.goal)
```  
### 3 WT STD/ENR
```{r}
WTS.mo3.probe=filter(mo3.probe, Strain=='WT'&`Housing`=='STD')
WTE.mo3.probe=filter(mo3.probe, Strain=='WT'&`Housing`=='ENR')
t.test(WTS.mo3.probe$time.in.zone.old.goal,WTE.mo3.probe$time.in.zone.old.goal)
```  
## {-}

no significance found  

<br>  

## t-Tests (Path length of all trials) between Strains {.tabset .tabset-fade .tabset-pills #anchor28}
  
***  

### 17-25 WT/dTg
```{r}
mo25.WT=filter(mo25, Strain=="WT")
mo25.dTg=filter(mo25, Strain=="dTg")
t.test(mo25.WT$path.length,mo25.dTg$path.length)
```  
### 17-25 WT/PS1dE9
```{r}
mo25.WT=filter(mo25, Strain=="WT")
mo25.PS=filter(mo25, Strain=="PS1dE9")
t.test(mo25.WT$path.length,mo25.PS$path.length)
```  
### 17-25 WT/APPswe
```{r}
mo25.WT=filter(mo25, Strain=="WT")
mo25.AP=filter(mo25, Strain=="APPswe")
t.test(mo25.WT$path.length,mo25.AP$path.length)
```
### 17-25 PS1dE9/APPswe
```{r}
mo25.PS=filter(mo25, Strain=="PS1dE9")
mo25.AP=filter(mo25, Strain=="APPswe")
t.test(mo25.PS$path.length,mo25.AP$path.length)
```  
### 17-25 dTg/PS1dE9
```{r}
mo25.dTg=filter(mo25, Strain=="dTg")
mo25.AP=filter(mo25, Strain=="PS1dE9")
t.test(mo25.dTg$path.length,mo25.PS$path.length)
```  
### 17-25 dTg/APPswe
```{r}
mo25.dTg=filter(mo25, Strain=="dTg")
mo25.AP=filter(mo25, Strain=="APPswe")
t.test(mo25.dTg$path.length,mo25.AP$path.length)
```

## t-Tests (Latency to goal of all trials) between Strains {.tabset .tabset-fade .tabset-pills #anchor29}
  
***  

### 17-25 WT/dTg
```{r}
mo25.WT=filter(mo25, Strain=="WT")
mo25.dTg=filter(mo25, Strain=="dTg")
t.test(mo25.WT$latency.to.goal,mo25.dTg$latency.to.goal)
```  
### 17-25 WT/PS1dE9
```{r}
mo25.WT=filter(mo25, Strain=="WT")
mo25.PS=filter(mo25, Strain=="PS1dE9")
t.test(mo25.WT$latency.to.goal,mo25.PS$latency.to.goal)
```  
### 17-25 WT/APPswe
```{r}
mo25.WT=filter(mo25, Strain=="WT")
mo25.AP=filter(mo25, Strain=="APPswe")
t.test(mo25.WT$latency.to.goal,mo25.AP$latency.to.goal)
```
### 17-25 PS1dE9/APPswe
```{r}
mo25.PS=filter(mo25, Strain=="PS1dE9")
mo25.AP=filter(mo25, Strain=="APPswe")
t.test(mo25.PS$latency.to.goal,mo25.AP$latency.to.goal)
```  
### 17-25 dTg/PS1dE9
```{r}
mo25.dTg=filter(mo25, Strain=="dTg")
mo25.AP=filter(mo25, Strain=="PS1dE9")
t.test(mo25.dTg$latency.to.goal,mo25.PS$latency.to.goal)
```  
### 17-25 dTg/APPswe
```{r}
mo25.dTg=filter(mo25, Strain=="dTg")
mo25.AP=filter(mo25, Strain=="APPswe")
t.test(mo25.dTg$latency.to.goal,mo25.AP$latency.to.goal)
```  

# Logistic regression {#anchor30}  
  
Results table can be seen [here](https://docs.google.com/spreadsheets/d/1l4cZd7b-e-g4R9bCtmnzOb2TT8EPAE8E/edit#gid=952962709)

## Strategy Legend  

* 1 - thigmotaxis  
* 2 - circling  
* 3 - random path  
* 4 - scanning  
* 5 - chaining  
* 6 - directed search  
* 7 - corrected search  
* 8 - direct path  
* 9 - perseverance  

***
  
Strategies 1-5 are less hippocampus-dependent, 'unspatial' and therefore get strategy.class = 0. 
In contrast to that, strategies 6-9 are more hippocampus-dependent, 'spatial' and get strategy.class = 1 assigned.  

All probabilities in the following codes relate to choosing strategy.class = 1.

***
```{r data import}
setwd("C:/Google/Uni/Bachelorarbeit/R/Analysis")
logistic.data=read_excel("logistic.reg.xlsx")
```

## Age group 17-25 Housing  {#anchor31 }

***  

```{r}
logistic.data.1725=filter(logistic.data, Age_group1725=='1')
```
fitting different logistic regression models with increasing complexity  
simple model including housing only
```{r}
logreg.1725.add.1a <- glm(strategy.class ~ Housing, family = binomial, data = logistic.data.1725)
```  
simple model including Strain only
```{r}
logreg.1725.add.1b <- glm(strategy.class ~ Strain, family = binomial, data = logistic.data.1725)
```  
additive model including all factors
```{r}
logreg.1725.add.2 <- glm(strategy.class ~ Housing + Strain, family = binomial, data = logistic.data.1725)
```  
interaction model including all factors
```{r}
logreg.1725.int <- glm(strategy.class ~ Housing * Strain, family = binomial, data = logistic.data.1725)
```
Model comparisons using the anova function
```{r}
anova(logreg.1725.add.1b, logreg.1725.add.1a, test="Chisq")
```
model including Strain better than model including housing
```{r}
anova(logreg.1725.add.2, logreg.1725.add.1b, test="Chisq")
```
adding factor housing does not improve the model
```{r}
anova(logreg.1725.int, logreg.1725.add.1b, test="Chisq")
```
interaction model not better than additive model
simple model including Strain only is the minimal adequate model

summary of minimal adequate model
```{r}
summary(logreg.1725.add.1b)
exp(coef(logreg.1725.add.1b))
```
impact of predictor "Strain"
```{r}
pred.data <- data.frame(Strain=c("WT", "dTg", "PS1dE9", "APPswe"))
pred.data$prob <- predict(logreg.1725.add.1b, newdata = pred.data, type = "response")
pred.data
```
impact of predictor "housing"
```{r}
pred.data2 <- data.frame(Housing=c("STD","ENR"))
pred.data2$prob <- predict(logreg.1725.add.1a, newdata = pred.data2, type = "response")
pred.data2
```  

## Age group 13-14 Strain x Housing effects {#anchor32}
  
***  

```{r}
logistic.data.1314=filter(logistic.data, Age_group1314=='1')
```
fitting different logistic regression models with increasing complexity
simple model including housing only
```{r}
logreg.1314.add.1a <- glm(strategy.class ~ Housing, family = binomial, data = logistic.data.1314)
```
simple model including Strain only
```{r}
logreg.1314.add.1b <- glm(strategy.class ~ Strain, family = binomial, data = logistic.data.1314)
```
additive model including all factors
```{r}
logreg.1314.add.2 <- glm(strategy.class ~ Housing + Strain, family = binomial, data = logistic.data.1314)
```
interaction model including all factors
```{r}
logreg.1314.int <- glm(strategy.class ~ Housing * Strain, family = binomial, data = logistic.data.1314)
```

model comparisons using the anova function
```{r}
anova(logreg.1314.add.1b, logreg.1314.add.1a, test="Chisq")
```
no Df, same model fit?
```{r}
anova(logreg.1314.add.2, logreg.1314.add.1b, test="Chisq")
```
additive model shows significantly better fit (Pr=0.01295)
```{r}
anova(logreg.1314.int, logreg.1314.add.1b, test="Chisq")
```
interaction model better than simple Strain model (Pr=0.00248)
interaction model including Strain*Housing is the best fitting model

summary of minimal adequate model
```{r}
summary(logreg.1314.int)
exp(coef(logreg.1314.int))
```
impact of predictor "Strain*Housing"
```{r}
pred.data <- data.frame(Strain=c("WT", "WT","dTg","dTg"),Housing=c("STD","ENR","STD","ENR"))
pred.data$prob <- predict(logreg.1314.int, newdata = pred.data, type = "response")
pred.data
```  

## Age group 3 Strain x Housing {#anchor33}
  
***  


```{r}
logistic.data.3=filter(logistic.data, Age_group3=='1')
```
fitting different logistic regression models with increasing complexity
simple model including housing only
```{r}
logreg.3.add.1a <- glm(strategy.class ~ Housing, family = binomial, data = logistic.data.3)
```
simple model including Strain only
```{r}
logreg.3.add.1b <- glm(strategy.class ~ Strain, family = binomial, data = logistic.data.3)
```
additive model including all factors
```{r}
logreg.3.add.2 <- glm(strategy.class ~ Housing + Strain, family = binomial, data = logistic.data.3)
```
interaction model including all factors
```{r}
logreg.3.int <- glm(strategy.class ~ Housing * Strain, family = binomial, data = logistic.data.3)
```
comparisons between model using the anova function
```{r}
anova(logreg.3.add.1b, logreg.3.add.1a, test="Chisq")
```
model with Strain only is really good (Pr=3.245e-13)
```{r}
anova(logreg.3.add.2, logreg.3.add.1b, test="Chisq")
```
adding factor housing also has good fit  (Pr=1.945e-5)
```{r}
anova(logreg.3.int, logreg.3.add.1b, test="Chisq")
```
interaction model better than additive model (Pr=5.648e-6)
interaction model is the best

summary of Strain only model
```{r}
summary(logreg.3.add.1b)
exp(coef(logreg.3.add.1b))  
```
summary of interaction model
```{r}
summary(logreg.3.int)
exp(coef(logreg.3.int))
```
impact of predictor "Strain"
```{r}
pred.data3 <- data.frame(Strain=c("WT", "dTg", "PS1dE9", "APPswe"))
pred.data3$prob <- predict(logreg.3.add.1b, newdata = pred.data3, type = "response")
pred.data3
```
impact of predictors "Strain x Housing"
```{r}
pred.data3x <- data.frame(Strain=c("WT","WT", "dTg","dTg", "PS1dE9","PS1dE9", "APPswe","APPswe"),Housing=c("STD","ENR","STD","ENR","STD","ENR","STD","ENR"))
pred.data3x$prob <- predict(logreg.3.int, newdata = pred.data3x, type = "response")
pred.data3x
```

The full overview of the [logistic regression results table](https://docs.google.com/spreadsheets/d/1l4cZd7b-e-g4R9bCtmnzOb2TT8EPAE8E/edit#gid=952962709) is here.

## Age group 17-25 acquisition Strain  {#anchor34 }

***  

```{r}
logistic.data.1725.acq=filter(logistic.data.1725, `_Day`=='1'|`_Day`=='2'|`_Day`=='3'|`_Day`=='4'|`_Day`=='5'|`_Day`=='6')
```
fitting different logistic regression models with increasing complexity  
simple model including housing only
```{r}
logreg.1725.acq.add.1a <- glm(strategy.class ~ Housing, family = binomial, data = logistic.data.1725.acq)
```  
simple model including Strain only
```{r}
logreg.1725.acq.add.1b <- glm(strategy.class ~ Strain, family = binomial, data = logistic.data.1725.acq)
```  
additive model including all factors
```{r}
logreg.1725.acq.add.2 <- glm(strategy.class ~ Housing + Strain, family = binomial, data = logistic.data.1725.acq)
```  
interaction model including all factors
```{r}
logreg.1725.acq.int <- glm(strategy.class ~ Housing * Strain, family = binomial, data = logistic.data.1725.acq)
```
Model comparisons using the anova function
```{r}
anova(logreg.1725.acq.add.1b, logreg.1725.acq.add.1a, test="Chisq")
```  
model including Strain better than model including housing
```{r}
anova(logreg.1725.acq.add.2, logreg.1725.acq.add.1b, test="Chisq")
```
adding factor housing does not improve the model
```{r}
anova(logreg.1725.acq.int, logreg.1725.acq.add.1b, test="Chisq")
```

```{r}
summary(logreg.1725.acq.int)
exp(coef(logreg.1725.acq.int))
```

impact of predictor "Strain"
```{r}
pred.data.17.acq <- data.frame(Strain=c("WT", "dTg", "PS1dE9", "APPswe"))
pred.data.17.acq$prob <- predict(logreg.1725.acq.add.1b, newdata = pred.data.17.acq, type = "response")
pred.data.17.acq
```

## Age group 17-25 reversal Strain  {#anchor35 }

***  

```{r}
logistic.data.1725.rev=filter(logistic.data.1725, `_Day`=='7'|`_Day`=='8'|`_Day`=='9'|`_Day`=='10')
```
fitting different logistic regression models with increasing complexity  
simple model including housing only
```{r}
logreg.1725.rev.add.1a <- glm(strategy.class ~ Housing, family = binomial, data = logistic.data.1725.rev)
```  
simple model including Strain only
```{r}
logreg.1725.rev.add.1b <- glm(strategy.class ~ Strain, family = binomial, data = logistic.data.1725.rev)
```  
additive model including all factors
```{r}
logreg.1725.rev.add.2 <- glm(strategy.class ~ Housing + Strain, family = binomial, data = logistic.data.1725.rev)
```  
interaction model including all factors
```{r}
logreg.1725.rev.int <- glm(strategy.class ~ Housing * Strain, family = binomial, data = logistic.data.1725.rev)
```
Model comparisons using the anova function
```{r}
anova(logreg.1725.rev.add.1b, logreg.1725.rev.add.1a, test="Chisq")
```  
model including Strain better than model including housing
```{r}
anova(logreg.1725.rev.add.2, logreg.1725.rev.add.1b, test="Chisq")
```
adding factor housing does not improve the model
```{r}
anova(logreg.1725.rev.int, logreg.1725.rev.add.1b, test="Chisq")
```
interaction model better than additive model

summary of minimal adequate model
```{r}
summary(logreg.1725.rev.int)
exp(coef(logreg.1725.rev.int))
```
impact of predictor "Strain"
```{r}
pred.data.17.revs <- data.frame(Strain=c("WT","WT", "dTg","dTg", "PS1dE9","PS1dE9", "APPswe","APPswe"),Housing=c("STD","ENR","STD","ENR","STD","ENR","STD","ENR"))
pred.data.17.revs$prob <- predict(logreg.1725.rev.int, newdata = pred.data.17.revs, type = "response")
pred.data.17.revs
```

## Age group 13-14 acquisition Strain x Housing {#anchor36}
  
***  


```{r}
logistic.data.acq.1314=filter(logistic.data.1314,  `_Day`=='1'|`_Day`=='2'|`_Day`=='3'|`_Day`=='4'|`_Day`=='5'|`_Day`=='6')
```
fitting different logistic regression models with increasing complexity
simple model including housing only
```{r}
logreg.1314.acq.add.1a <- glm(strategy.class ~ Housing, family = binomial, data = logistic.data.acq.1314)
```
simple model including Strain only
```{r}
logreg.1314.acq.add.1b <- glm(strategy.class ~ Strain, family = binomial, data = logistic.data.acq.1314)
```
additive model including all factors
```{r}
logreg.1314.acq.add.2 <- glm(strategy.class ~ Housing + Strain, family = binomial, data = logistic.data.acq.1314)
```
interaction model including all factors
```{r}
logreg.1314.acq.int <- glm(strategy.class ~ Housing * Strain, family = binomial, data = logistic.data.acq.1314)
```
comparisons between model using the anova function
```{r}
anova(logreg.1314.acq.add.1b, logreg.1314.acq.add.1a, test="Chisq")
```
model with Strain only is good
```{r}
anova(logreg.1314.acq.add.2, logreg.1314.acq.add.1b, test="Chisq")
```
adding factor housing also has good fit 
```{r}
anova(logreg.1314.acq.int, logreg.1314.acq.add.1b, test="Chisq")
```
additive model better than interaction model
additive model is the best

summary of interactive model
```{r}
summary(logreg.1314.acq.int)
exp(coef(logreg.1314.acq.int))
```

impact of predictors "Strain x Housing"
```{r}
pred.data1314.acq <- data.frame(Strain=c("WT","WT", "dTg","dTg"),Housing=c("STD","ENR","STD","ENR"))
pred.data1314.acq$prob <- predict(logreg.1314.acq.int, newdata = pred.data1314.acq, type = "response")
pred.data1314.acq
```  

## Age group 13-14 reversal Strain x Housing {#anchor37}
  
***  


```{r}
logistic.data.rev.1314=filter(logistic.data.1314,  `_Day`=='7'|`_Day`=='8'|`_Day`=='9'|`_Day`=='10')
```
fitting different logistic regression models with increasing complexity
simple model including housing only
```{r}
logreg.1314.rev.add.1a <- glm(strategy.class ~ Housing, family = binomial, data = logistic.data.rev.1314)
```
simple model including Strain only
```{r}
logreg.1314.rev.add.1b <- glm(strategy.class ~ Strain, family = binomial, data = logistic.data.rev.1314)
```
additive model including all factors
```{r}
logreg.1314.rev.add.2 <- glm(strategy.class ~ Housing + Strain, family = binomial, data = logistic.data.rev.1314)
```
interaction model including all factors
```{r}
logreg.1314.rev.int <- glm(strategy.class ~ Housing * Strain, family = binomial, data = logistic.data.rev.1314)
```
comparisons between model using the anova function
```{r}
anova(logreg.1314.rev.add.1b, logreg.1314.rev.add.1a, test="Chisq")
```
```{r}
anova(logreg.1314.rev.add.2, logreg.1314.rev.add.1b, test="Chisq")
```
adding factor does not improve model
```{r}
anova(logreg.1314.rev.int, logreg.1314.rev.add.1b, test="Chisq")
```
interaction model better than additive model
interaction model is the best

summary of interaction model
```{r}
summary(logreg.1314.rev.int)
exp(coef(logreg.1314.rev.int))
```

impact of predictors "Strain x Housing"
```{r}
pred.data1314.rev <- data.frame(Strain=c("WT","WT", "dTg","dTg"),Housing=c("STD","ENR","STD","ENR"))
pred.data1314.rev$prob <- predict(logreg.1314.rev.int, newdata = pred.data1314.rev, type = "response")
pred.data1314.rev
```

## Age group 3 acquisition Strain x Housing {#anchor38}
  
***  


```{r}
logistic.data.acq.3=filter(logistic.data.3,  `_Day`=='1'|`_Day`=='2'|`_Day`=='3'|`_Day`=='4'|`_Day`=='5'|`_Day`=='6')
```
fitting different logistic regression models with increasing complexity
simple model including housing only
```{r}
logreg.3.acq.add.1a <- glm(strategy.class ~ Housing, family = binomial, data = logistic.data.acq.3)
```
simple model including Strain only
```{r}
logreg.3.acq.add.1b <- glm(strategy.class ~ Strain, family = binomial, data = logistic.data.acq.3)
```
additive model including all factors
```{r}
logreg.3.acq.add.2 <- glm(strategy.class ~ Housing + Strain, family = binomial, data = logistic.data.acq.3)
```
interaction model including all factors
```{r}
logreg.3.acq.int <- glm(strategy.class ~ Housing * Strain, family = binomial, data = logistic.data.acq.3)
```
comparisons between model using the anova function
```{r}
anova(logreg.3.acq.add.1b, logreg.3.acq.add.1a, test="Chisq")
```
model with Strain only is really good
```{r}
anova(logreg.3.acq.add.2, logreg.3.acq.add.1b, test="Chisq")
```
adding factor housing also has good fit  
```{r}
anova(logreg.3.acq.int, logreg.3.acq.add.1b, test="Chisq")
```
interaction model better than additive model
interaction model is the best

summary of interaction model
```{r}
summary(logreg.3.acq.int)
exp(coef(logreg.3.acq.int))
```

impact of predictors "Strain x Housing"
```{r}
pred.data3.acq <- data.frame(Strain=c("WT","WT", "dTg","dTg", "PS1dE9","PS1dE9", "APPswe","APPswe"),Housing=c("STD","ENR","STD","ENR","STD","ENR","STD","ENR"))
pred.data3.acq$prob <- predict(logreg.3.acq.int, newdata = pred.data3.acq, type = "response")
pred.data3.acq
```  

## Age group 3 reversal Strain x Housing {#anchor39}
  
***  


```{r}
logistic.data.rev.3=filter(logistic.data.3,  `_Day`=='7'|`_Day`=='8'|`_Day`=='9'|`_Day`=='10')
```
fitting different logistic regression models with increasing complexity
simple model including housing only
```{r}
logreg.3.rev.add.1a <- glm(strategy.class ~ Housing, family = binomial, data = logistic.data.rev.3)
```
simple model including Strain only
```{r}
logreg.3.rev.add.1b <- glm(strategy.class ~ Strain, family = binomial, data = logistic.data.rev.3)
```
additive model including all factors
```{r}
logreg.3.rev.add.2 <- glm(strategy.class ~ Housing + Strain, family = binomial, data = logistic.data.rev.3)
```
interaction model including all factors
```{r}
logreg.3.rev.int <- glm(strategy.class ~ Housing * Strain, family = binomial, data = logistic.data.rev.3)
```
comparisons between model using the anova function
```{r}
anova(logreg.3.rev.add.1b, logreg.3.rev.add.1a, test="Chisq")
```
model with Strain only is really good (Pr=3.245e-13)
```{r}
anova(logreg.3.rev.add.2, logreg.3.rev.add.1b, test="Chisq")
```
adding factor housing also has good fit  (Pr=1.945e-5)
```{r}
anova(logreg.3.rev.int, logreg.3.rev.add.1b, test="Chisq")
```
interaction model better than additive model (Pr=5.648e-6)
interaction model is the best

summary of interaction model
```{r}
summary(logreg.3.rev.int)
exp(coef(logreg.3.rev.int))
```

impact of predictors "Strain x Housing"
```{r}
pred.data3.rev <- data.frame(Strain=c("WT","WT", "dTg","dTg", "PS1dE9","PS1dE9", "APPswe","APPswe"),Housing=c("STD","ENR","STD","ENR","STD","ENR","STD","ENR"))
pred.data3.rev$prob <- predict(logreg.3.rev.int, newdata = pred.data3.rev, type = "response")
pred.data3.rev
```  

## Results 

Results table can be seen [here](https://docs.google.com/spreadsheets/d/1l4cZd7b-e-g4R9bCtmnzOb2TT8EPAE8E/edit#gid=952962709)

# Strategy Overview plot {#anchor40} 

```{r fig.align = "center",out.width="200%"}
knitr::include_graphics("strategy.png")
```  
  
# Visualization results log. reg {#anchor41}   

## 2D - Age group 3 {#anchor41.1}
```{r}
setwd("C:/Google/Uni/Bachelorarbeit/R/Analysis")
probs=read_excel("results_logistic.xlsx")
probs$`Experiment_Phase`=as.factor(probs$`Experiment_Phase`)
probs3=filter(probs, Age_group=='3' & Model=='STRAIN*HOUSING')

gg = ggplot(probs3, mapping=aes(x=Strain, y=Probability, color=Housing)) + geom_jitter() + facet_grid(~Experiment_Phase) + labs(x="Strain", y="P(strategy.class 1)", title="Probability of 3 months old mice using Strategy class 1")

ggplotly(p=gg, height=400, width=800)
```  
Strain*Housing interaction model used for predictions.  

## 2D - Age group 13-14 {#anchor41.2}
```{r}
probs13=filter(probs, Age_group=='13-14' & Model=='STRAIN*HOUSING')

gg = ggplot(probs13, mapping=aes(x=Strain, y=Probability, color=Housing)) + geom_jitter() + facet_grid(~Experiment_Phase) + labs(x="Strain", y="P(strategy.class 1)", title="Probability of 13-14 months old mice using Strategy class 1")
ggplotly(gg, height=400, width=800)
```  
For Aquisition phase additive model is the best. Should it be used?
Strain*Housing interaction model used for predictions.  

## 2D - Age group 17-25 {#anchor41.3}
```{r}
probs17=filter(probs, Age_group=='17-25')

gg = ggplot(probs17, mapping=aes(x=Strain, y=Probability, color=Housing)) + geom_jitter() + facet_grid(~Experiment_Phase) + labs(x="Strain", y="P(strategy.class 1)", title="Probability of 17-25 months old mice using Strategy class 1", caption="test")
ggplotly(gg, height=400, width=800)
```
Strategy.class ~ Strain and Strategy.class ~ Housing models were used separately for ACQ and Both experiment phases. REV phase has best model fit with interaction model.  

## 3D Surface Plot {#anchor41.4}
```{r}
x=c("WT","dTg","PS1dE9","APPswe")
y=c("STD","ENR","ACQ STD","ACQ ENR", "REV STD", "REV ENR")
z=rbind(
  c(0.1061947,-0.05573,0.0375,-0.1498423),
  c(-0.1507937,0.0186289,0.1675978,-0.1517572),
  c(0.1498674,0.1509217,0.0564133,0.1590389),
  c(-0.0239207,0.0772358,0.1177536,0.137224),
  c(-0.0544041,0.0931034,0.0140845,-0.0099778),
  c(0.0010616,0.2090069,0.1390805,-0.2368421)
)
z2=rbind(
  c(0,0,0,0),c(0,0,0,0),c(0,0,0,0),c(0,0,0,0),c(0,0,0,0),c(0,0,0,0))
  
ebene= plot_ly(type="surface", x=~x, y=~y, z=~z)
ebene= ebene %>% add_surface(z=~z2)
ebene= ebene %>% layout( title='Probability of Strategy class 1 in 3 months old mice')
ebene
```

Interactive plot created with `plotly`[@sievert_plotly_2021] library. 

testing citations[@garthe_mice_2016] 

RTrack package used[@overall_rtrack_2020]

# References {#ref}