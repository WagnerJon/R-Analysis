---
title: "RTrack Analysis"
author: "Jonas Wagner"
output:
  html_document:
    df_print: paged
  html_notebook: toc:TRUE number_sections:TRUE
  pdf_document: default
---
## Table of Contents {#anchor99}

* [Importing Data](#anchor)  
* [Analysis of experiment metrics](#anchor2)  
* [Heatmap](#anchor3)  
* [Heatmap_reversal](#anchor4)  
* [Calling strategies](#anchor5)  
* [Thresholding strategies](#anchor6)  
* [Plotting strategies](#anchor7)  
* [Plotting thresholded strategies](#anchor8)  
* [Saving the results](#anchor9)  
* [Plotting with ggplot2](#anchor10) 
* [Graphs Gallery](#anchor11)
* [Path Length Graphs](#anchor12)
* [Latency Graphs](#anchor13)
* [UPDATED Heatmaps](#anchor14)
* [UPDATED Path length Graphs](#anchor15)
* [UPDATED Mean Velocity Graphs](#anchor16)
* [UPDATED Strategy Graphs](#anchor17)

```{r setup, include=FALSE, echo=FALSE}
require("knitr")
knitr::opts_chunk$set(echo = TRUE,fig.width = 7,fig.height = 4)
opts_knit$set(root.dir = "F:/Bachelor/Daten/Bulk_all")
library(Rtrack)
library(knitr)
library(DT)
library(dplyr)
library(ggplot2)
library(readxl)
library(ggsci)
library(tidyverse)
library(ggh4x)
```

## Importing Data {#anchor}

```{r import,results=FALSE}
cluster = parallel::makeCluster(rep("localhost", parallel::detectCores()), type = "SOCK")
experiment = Rtrack::read_experiment("Experiment_description2.xlsx", format = "Excel", cluster = cluster) 
#Closing multicore cluster to reduce system load
parallel::stopCluster(cluster)
```
## Analysis of experiment metrics {#anchor2}

These metrics can be compared and extracted from the pure track files.

```{r}
experiment$summary.variables
```
 [back to top](#anchor99)
```{r}
par(mfrow = c(2, 2))
Rtrack::plot_variable("path.length", experiment = experiment, factor = "Strain", exclude.probe = TRUE,lwd = 2)
Rtrack::plot_variable("path.length", experiment = experiment, factor = "Age_group", exclude.probe = TRUE,lwd = 2)
Rtrack::plot_variable("path.length", experiment = experiment, factor = "Housing", exclude.probe = TRUE,lwd = 2)
Rtrack::plot_variable("path.length", experiment = experiment, factor = "All", exclude.probe = TRUE,lwd = 2)
```
[back to top](#anchor99)

## Heatmap {#anchor3}
```{r heatmap}
wt.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
(experiment$factors$`_Day` == 1 | experiment$factors$`_Day` == 2 | experiment$factors$`_Day` == 3 | experiment$factors$`_Day` == 4|
experiment$factors$`_Day` == 5| experiment$factors$`_Day` == 6)]
dTg.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
(experiment$factors$`_Day` == 1 | experiment$factors$`_Day` == 2 | experiment$factors$`_Day` == 3 | experiment$factors$`_Day` == 4| experiment$factors$`_Day` == 5| experiment$factors$`_Day` == 6)]
APP.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
(experiment$factors$`_Day` == 1 | experiment$factors$`_Day` == 2 | experiment$factors$`_Day` == 3 | experiment$factors$`_Day` == 4| experiment$factors$`_Day` == 5| experiment$factors$`_Day` == 6)]
PS1.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
(experiment$factors$`_Day` == 1 | experiment$factors$`_Day` == 2 | experiment$factors$`_Day` == 3 | experiment$factors$`_Day` == 4| experiment$factors$`_Day` == 5| experiment$factors$`_Day` == 6)]
par(mfrow = c(2, 2))
Rtrack::plot_density(wt.metrics, title = "wt Heatmap",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(dTg.metrics, title = "dTg Heatmap",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(APP.metrics, title = "APPswe Heatmap",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(PS1.metrics, title = "PS1dE9 Heatmap",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
```
[back to top](#anchor99)

## Heatmap_reversal {#anchor4}
```{r heatmap reversal}
wtr.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
                                           (experiment$factors$`_Day` == 7 | experiment$factors$`_Day` == 8 | experiment$factors$`_Day` == 9 | experiment$factors$`_Day` == 10)]
dTgr.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
                                            (experiment$factors$`_Day` == 7 | experiment$factors$`_Day` == 8 | experiment$factors$`_Day` == 9 | experiment$factors$`_Day` == 10)]
APPr.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
                                  (experiment$factors$`_Day` ==7 | experiment$factors$`_Day` == 8 | experiment$factors$`_Day` == 9 | experiment$factors$`_Day` == 10)]
PS1r.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
                                   (experiment$factors$`_Day` == 7 | experiment$factors$`_Day` == 8 | experiment$factors$`_Day` == 9 | experiment$factors$`_Day` == 10)]
par(mfrow = c(2, 2))
Rtrack::plot_density(wtr.metrics, title = "WT_reversal Heatmap",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(dTgr.metrics, title = "dTg_reversal Heatmap",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(APPr.metrics, title = "APPswe_reversal Heatmap",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(PS1r.metrics, title = "PS1dE9_reversal Heatmap",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
```
[back to top](#anchor99)

## Calling strategies {#anchor5}
```{r}
strategies = Rtrack::call_strategy(experiment$metrics)
```

## Thresholding strategies {#anchor6}

limits called strategies to those, where confidence is greater than 40%

```{r}
dim(Rtrack::threshold_strategies(strategies, 0.4)$calls)
```
[back to top](#anchor99)

## Plotting strategies of all age groups combined {#anchor7}
```{r}
par(mfrow = c(2, 2))
Rtrack::plot_strategies(strategies, experiment = experiment, factor = "Strain",
    exclude.probe = TRUE)
```
[back to top](#anchor99)

## Plotting thresholded strategies of all age groups combined {#anchor8}
```{r}
par(mfrow = c(2, 2))
Rtrack::plot_strategies(Rtrack::threshold_strategies(strategies, 0.4), experiment = experiment,
                        factor = "Strain", exclude.probe = TRUE)
```
[back to top](#anchor99)

## Saving the results {#anchor9}
Here we export the results of the analyzed Track Files into a data.frame, to analyse them further.
```{r}
results = Rtrack::export_results(experiment)
datatable(results, rownames = FALSE, filter="top", options = list(pageLength = 5, scrollX=T) )
```
[back to top](#anchor99)

## Plotting with ggplot2 {#anchor10}
```{r warning=FALSE}
library(ggplot2)
library(readxl)
Results=read_excel("Results2.xlsx")
ggplot(Results, aes(x=`_Day`,y=path.length,color=factor(Strain)))+geom_jitter()
Results

```
[back to top](#anchor99)  

## CAREFUL!!! The graphs below still include the probe trials (day 7 trial 1). To remove them add:   Probe=='FALSE' to filter{#anchor11}   


## Path Length Graphs {#anchor12}
```{r path length}

WT_STD=filter(Results, Strain=='WT'&Housing=='STD')
dTg_STD=filter(Results, Strain=='dTg'&Housing=='STD')
APP_STD=filter(Results, Strain=='APPswe'&Housing=='STD')
PS_STD=filter(Results, Strain=='PS1dE9'&Housing=='STD')
WT_ENR=filter(Results, Strain=='WT'&Housing=='ENR')
dTg_ENR=filter(Results, Strain=='dTg'&Housing=='ENR')
APP_ENR=filter(Results, Strain=='APPswe'&Housing=='ENR')
PS_ENR=filter(Results, Strain=='PS1dE9'&Housing=='ENR')
par(mfrow = c(2, 4))

WT_STD %>%
  mutate(WT_STD, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
  ggplot(aes(x=`_Day`,y=path.length, fill=Age_group))+geom_boxplot()+
    labs(x="Day",
       y="Average Path length",
       title="Mean Path length WT STD")+scale_fill_jco()
dTg_STD  %>%
mutate(dTg_STD, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=path.length, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Path length",
       title="Mean Path length dTg STD")+scale_fill_jco()
APP_STD  %>%
mutate(APP_STD, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=path.length, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Path length",
       title="Mean Path length APPswe1 STD")+scale_fill_jco()
PS_STD  %>%
mutate(PS_STD, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=path.length, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Path length",
       title="Mean Path length PS1dE9 STD")+scale_fill_jco()
WT_ENR  %>%
mutate(WT_ENR, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=path.length, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Path length",
       title="Mean Path length WT ENR")+scale_fill_jco()
dTg_ENR  %>%
mutate(dTg_ENR, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=path.length, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Path length",
       title="Mean Path length dTg ENR")+scale_fill_jco()
APP_ENR  %>%
mutate(APP_ENR, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=path.length, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Path length",
       title="Mean Path length APPswe1 ENR")+scale_fill_jco()
PS_ENR  %>%
mutate(PS_ENR, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=path.length, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Path length",
       title="Mean Path length PS1dE9 ENR")+scale_fill_jco()+
  facet_wrap(~Age_group)
```
[back to top](#anchor99)

## Latency Graphs{#anchor13}
```{r Latency}
WT_STD %>%
  mutate(WT_STD, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
  ggplot(aes(x=`_Day`,y=latency.to.goal, fill=Age_group))+geom_boxplot()+
    labs(x="Day",
       y="Average Latency in s",
       title="Mean Latency in s WT STD")+scale_fill_jco()
dTg_STD  %>%
mutate(dTg_STD, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=latency.to.goal, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Latency in s",
       title="Mean Latency in s dTg STD")+scale_fill_jco()
APP_STD  %>%
mutate(APP_STD, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=latency.to.goal, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Latency in s",
       title="Mean Latency in s APPswe1 STD")+scale_fill_jco()
PS_STD  %>%
mutate(PS_STD, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=latency.to.goal, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Latency in s",
       title="Mean Latency in s PS1dE9 STD")+scale_fill_jco()
WT_ENR  %>%
mutate(WT_ENR, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=latency.to.goal, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Latency in s",
       title="Mean Latency in s WT ENR")+scale_fill_jco()
dTg_ENR  %>%
mutate(dTg_ENR, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=latency.to.goal, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Latency in s",
       title="Mean Latency in s dTg ENR")+scale_fill_jco()
APP_ENR  %>%
mutate(APP_ENR, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=latency.to.goal, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Latency in s",
       title="Mean Latency in s APPswe1 ENR")+scale_fill_jco()
PS_ENR  %>%
mutate(PS_ENR, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=latency.to.goal, fill=Age_group))+geom_boxplot()+
  labs(x="Day",
       y="Average Latency in s",
       title="Mean Latency in s PS1dE9 ENR")+scale_fill_jco()+
  facet_wrap(~Age_group)
```
[back to top](#anchor99)

## UPDATED Heatmap_probe {#anchor14}
```{r filtering for heatmaps, include=FALSE}
#############Probe_Trials##################
wtp.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1)]
dTgp.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1)]
APPp.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1)]
PS1p.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1)]
###########################################
##############Probe_Trials_STD#############
wtpstd.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD")]

dTgpstd.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD")]

APPpstd.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD")]

PS1pstd.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD")]
#######################################
##############Probe_Trials_ENR#########
wtpenr.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR")]
dTgpenr.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR")]
APPpenr.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR")]
PS1penr.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR")]
####################################################
################Probe_Trial_Age_groups##############
#######################3_months#####################
wtpstd3.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="3")]

dTgpstd3.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="3")]

APPpstd3.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="3")]

PS1pstd3.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="3")]
#######################################
##############Probe_Trials_ENR#########
wtpenr3.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="3")]
dTgpenr3.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="3")]
APPpenr3.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="3")]
PS1penr3.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="3")]
#######################13-14_months#####################
wtpstd14.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="13-14")]

dTgpstd14.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="13-14")]

APPpstd14.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="13-14")]

PS1pstd14.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="13-14")]
#######################################
##############Probe_Trials_ENR#########
wtpenr14.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="13-14")]
dTgpenr14.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="13-14")]
APPpenr14.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="13-14")]
PS1penr14.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="13-14")]
#######################17-25_months#####################
wtpstd25.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="17-25")]

dTgpstd25.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="17-25")]

APPpstd25.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="17-25")]

PS1pstd25.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="STD"&experiment$factors$Age_group=="17-25")]
#######################################
##############Probe_Trials_ENR#########
wtpenr25.metrics = experiment$metrics[experiment$factors$Strain == "WT" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="17-25")]
dTgpenr25.metrics = experiment$metrics[experiment$factors$Strain == "dTg" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="17-25")]
APPpenr25.metrics = experiment$metrics[experiment$factors$Strain == "APPswe" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="17-25")]
PS1penr25.metrics = experiment$metrics[experiment$factors$Strain == "PS1dE9" &
    (experiment$factors$`_Day` == 7&experiment$factors$`_Trial`==1&experiment$factors$Housing=="ENR"&experiment$factors$Age_group=="17-25")]
```

```{r heatmap probe}
par(mfrow = c(2, 2))
Rtrack::plot_density(wtp.metrics, title = "WT Probe Heatmap 3-25mo",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(dTgp.metrics, title = "dTg Probe Heatmap 3-25mo",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(APPp.metrics, title = "APPswe Probe Heatmap 3-25mo",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(PS1p.metrics, title = "PS1dE9 Probe Heatmap 3-25mo",
                     col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
```

```{r heatmap probe ENR&STD}
par(mfrow = c(2, 4))
Rtrack::plot_density(wtpstd.metrics, title = "WT Probe Heatmap STD 3-25mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(dTgpstd.metrics, title = "dTg Probe Heatmap STD 3-25mo",    col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(APPpstd.metrics, title = "APPswe Probe Heatmap STD 3-25mo", col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(PS1pstd.metrics, title = "PS1dE9 Probe Heatmap STD 3-25mo", col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(wtpenr.metrics, title = "WT Probe Heatmap ENR 3-25mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(dTgpenr.metrics, title = "dTg Probe Heatmap ENR 3-25mo",    col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(APPpenr.metrics, title = "APPswe Probe Heatmap ENR 3-25mo", col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(PS1penr.metrics, title = "PS1dE9 Probe Heatmap ENR 3-25mo", col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
```
WT -> dTg -> APPswe -> PS1dE9
[back to top](#anchor99)
```{r heatmap probe Age_groups}
par(mfrow = c(1, 3))
###########WT_Probe##########
Rtrack::plot_density(wtpstd3.metrics, title = "WT Probe Heatmap STD 3mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(wtpstd14.metrics, title = "WT Probe Heatmap STD 13-14mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(wtpstd25.metrics, title = "WT Probe Heatmap STD 17-25mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(wtpenr3.metrics, title = "WT Probe Heatmap ENR 3mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(wtpenr14.metrics, title = "WT Probe Heatmap ENR 13-14mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(wtpenr25.metrics, title = "WT Probe Heatmap ENR 17-25mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
###########dTg_Probe##########
Rtrack::plot_density(dTgpstd3.metrics, title = "dTg Probe Heatmap STD 3mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(dTgpstd14.metrics, title = "dTg Probe Heatmap STD 13-14mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(dTgpstd25.metrics, title = "dTg Probe Heatmap STD 17-25mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(dTgpenr3.metrics, title = "dTg Probe Heatmap ENR 3mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(dTgpenr14.metrics, title = "dTg Probe Heatmap ENR 13-14mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(dTgpenr25.metrics, title = "dTg Probe Heatmap ENR 17-25mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
###########APP_Probe##########
Rtrack::plot_density(APPpstd3.metrics, title = "APPswe Probe Heatmap STD 3mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
#Rtrack::plot_density(APPpstd14.metrics, title = "APPswe Probe Heatmap STD 13-14mo",
#  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(APPpstd25.metrics, title = "APPswe Probe Heatmap STD 17-25mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(APPpenr3.metrics, title = "APPswe Probe Heatmap ENR 3mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
#Rtrack::plot_density(APPpenr14.metrics, title = "APPswe Probe Heatmap ENR 13-14mo",
#  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(APPpenr25.metrics, title = "APPswe Probe Heatmap ENR 17-25mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
###########PS1_Probe##########
Rtrack::plot_density(PS1pstd3.metrics, title = "PS1dE9 Probe Heatmap STD 3mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
#Rtrack::plot_density(PS1pstd14.metrics, title = "PS1dE9 Probe Heatmap STD 13-14mo",
#  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(PS1pstd25.metrics, title = "PS1dE9 Probe Heatmap STD 17-25mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(PS1penr3.metrics, title = "PS1dE9 Probe Heatmap ENR 3mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
#Rtrack::plot_density(PS1penr14.metrics, title = "PS1dE9 Probe Heatmap ENR 13-14mo",
#  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
Rtrack::plot_density(PS1penr25.metrics, title = "PS1dE9 Probe Heatmap ENR 17-25mo",
  col = colorRampPalette(c("#000C9E", "#00FEF6", "#FE009E"))(100))
```
[back to top](#anchor99)

## UPDATED Path Length Graphs {#anchor15}
```{r path length updated}

mo3=filter(Results, Age_group=='3')
mo14=filter(Results, Age_group=='13-14')
mo25=filter(Results, Age_group=='17-25')

mo3 %>%
  mutate(mo3, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
  ggplot(aes(x=`_Day`,y=path.length, fill=Condition))+geom_boxplot()+
    labs(x="Day",
       y="Average Path length",
       title="Mean Path length 3mo mice")+scale_fill_manual(values = c("dTg_ENR" = "#ad5fc9", "dTg_STD" = "#bc91cc","WT_ENR" = "#6eca64", "WT_STD" = "#98cc93","APPswe_ENR" = "#d6564b", "APPswe_STD" = "#db867f","PS1dE9_ENR" = "#918730", "PS1dE9_STD" = "#c5b740"))
mo14  %>%
mutate(mo14, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=path.length, fill=Condition))+geom_boxplot()+
  labs(x="Day",
       y="Average Path length",
       title="Mean Path length 13-14mo mice")+scale_fill_manual(values = c("dTg_ENR" = "#ad5fc9", "dTg_STD" = "#bc91cc","WT_ENR" = "#6eca64", "WT_STD" = "#98cc93","APPswe_ENR" = "#d6564b", "APPswe_STD" = "#db867f","PS1dE9_ENR" = "#918730", "PS1dE9_STD" = "#c5b740"))
mo25  %>%
mutate(mo25, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=path.length, fill=Condition))+geom_boxplot()+
  labs(x="Day",
       y="Average Path length",
       title="Mean Path length 17-25mo mice")+scale_fill_manual(values = c("dTg_ENR" = "#6c7ed7", "dTg_STD" = "#909ef3","WT_ENR" = "#9f48a3", "WT_STD" = "#ce73cf","APPswe_ENR" = "#c85632", "APPswe_STD" = "#e9724b","PS1dE9_ENR" = "#9f9201", "PS1dE9_STD" = "#cab95b"))
```
[back to top](#anchor99)

Boxplot explanation:   
Middle line in box -> Median   
Box -> shows middle 50% of data(Distance between 1. and 3. Quartil)   
Whisker(vertikal lines) -> show upper/lower 25% of data w/o outliers   
Points -> outlier   

## UPDATED Velocity (Mean) Graphs {#anchor16}
```{r velocity updated}

mo3=filter(Results, Age_group=='3')
mo14=filter(Results, Age_group=='13-14')
mo25=filter(Results, Age_group=='17-25')

mo3 %>%
  mutate(mo3, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
  ggplot(aes(x=`_Day`,y=mean.velocity, fill=Condition))+geom_boxplot()+
    labs(x="Day",
       y="Average Velocity",
       title="Mean Velocity 3mo mice")+scale_fill_manual(values = c("dTg_ENR" = "#ad5fc9", "dTg_STD" = "#bc91cc","WT_ENR" = "#6eca64", "WT_STD" = "#98cc93","APPswe_ENR" = "#d6564b", "APPswe_STD" = "#db867f","PS1dE9_ENR" = "#918730", "PS1dE9_STD" = "#c5b740"))
mo14  %>%
mutate(mo14, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=mean.velocity, fill=Condition))+geom_boxplot()+
  labs(x="Day",
       y="Average Velocity",
       title="Mean Velocity 13-14mo mice")+scale_fill_manual(values = c("dTg_ENR" = "#ad5fc9", "dTg_STD" = "#bc91cc","WT_ENR" = "#6eca64", "WT_STD" = "#98cc93","APPswe_ENR" = "#d6564b", "APPswe_STD" = "#db867f","PS1dE9_ENR" = "#918730", "PS1dE9_STD" = "#c5b740"))
mo25  %>%
mutate(mo25, `_Day`=fct_relevel(`_Day`,"1","2","3","4","5","6","7","8","9","10"))%>%
ggplot(aes(x=`_Day`,y=mean.velocity, fill=Condition))+geom_boxplot()+
  labs(x="Day",
       y="Average Velocity",
       title="Mean Velocity 17-25mo mice")+scale_fill_manual(values = c("dTg_ENR" = "#6c7ed7", "dTg_STD" = "#909ef3","WT_ENR" = "#9f48a3", "WT_STD" = "#ce73cf","APPswe_ENR" = "#c85632", "APPswe_STD" = "#e9724b","PS1dE9_ENR" = "#9f9201", "PS1dE9_STD" = "#cab95b"))
```
[back to top](#anchor99)

## UPDATED Strategy (Thresholded) Graphs {#anchor17}
```{r}
par(mfrow = c(2, 2))
Rtrack::plot_strategies(Rtrack::threshold_strategies(strategies, 0.4), experiment = experiment,
                        factor = "All", exclude.probe = TRUE)
```
[back to top](#anchor99)
